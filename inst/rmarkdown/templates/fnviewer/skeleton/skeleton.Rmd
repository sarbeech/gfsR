---
title: "Fishnet Data Viewer"
author: "Jeremy Holden"
date: "Compile on `r format(Sys.time(), '%d %B, %Y')`"
output: html_document
params:
  datazip: ~/Fishnet/GL1/IA18_GL1/DATA.ZIP
---
<!-- this document is intended to be run using "knit with parameters" -->
<!-- the user can then provide a file path to a DATA.ZIP file to generate a report -->
<!-- alternatively the datazip paramater can be edited above -->
<!-- this text above this line wil not be rendered in the final document -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(gfsR)
library(kableExtra)
library(dplyr)
```

## Import DATA.ZIP
```{r dataname, echo=TRUE}
print(params$datazip)
```

```{r import, include=FALSE}
fndat <- import_fn_index_net(params$datazip)
```


## FN011
```{r fn011}
fndat$FN011 |> 
  select(PRJ_CD, PRJ_NM, PRJ_LDR, FOF_NM, WBY_NM, PRJ_DATE0, PRJ_DATE1) |> 
  kbl() |> 
  kable_styling(position="left", full_width = F)
```

## FN121
```{r fn121table}
if("AREA" %in% fndat$FN121){
  fndat$FN121 |> 
    group_by(AREA) |> 
    summarize(N = n()) |> 
    kbl() |> 
    kable_styling(position="left", full_width = F)
}

```

```{r fn121map}
library(leaflet)
leaflet(fndat$FN121) |> addTiles() |> addCircles(lat =~DD_LAT0, lng = ~DD_LON0)
```

### check for missing coordinate
```{r}
##want to make these give message outputs i.e. if true return table, if false return "none"
filter(fndat$FN121, is.na(DD_LAT0))
filter(fndat$FN121, is.na(DD_LON0))
filter(fndat$FN121, is.na(DD_LAT1))
filter(fndat$FN121, is.na(DD_LON1))
```

## FN123
### Check for NA's in CATCNT, SUBCNT, CATWT, CATWT
```{r}
fn123<-fndat$FN123
filter(fn123,is.na(CATCNT))
filter(fn123,is.na(CATWT))
filter(fn123,is.na(SUBCNT))
filter(fn123,is.na(SUBWT))


```
### Check for BIOCNT > CATCNT
```{r}
fn123$BIOCNT<-is.numeric(fn123$BIOCNT)
fn123$CATCNT<-is.numeric(fn123$CATCNT)
fn123%>%filter(BIOCNT>CATCNT)
```


## FN125
```{r fn125}
fndat$FN125 |> 
  group_by(SPC) |> 
  summarize(N = n()) |> 
  kbl()
```

